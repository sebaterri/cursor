{
  "files": [
    {
      "path": "package.json",
      "content": "{\n  \"name\": \"fantasy-soccer-backend\",\n  \"version\": \"1.0.0\",\n  \"description\": \"Backend for the interactive fantasy soccer dashboard\",\n  \"main\": \"dist/index.js\",\n  \"scripts\": {\n    \"start\": \"node dist/index.js\",\n    \"dev\": \"nodemon src/index.ts\",\n    \"build\": \"tsc\",\n    \"test\": \"echo \\\"Error: no test specified\\\" && exit 1\"\n  },\n  \"keywords\": [],\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"dependencies\": {\n    \"express\": \"^4.18.2\"\n  },\n  \"devDependencies\": {\n    \"@types/express\": \"^4.17.21\",\n    \"@types/node\": \"^20.11.5\",\n    \"nodemon\": \"^3.0.3\",\n    \"ts-node\": \"^10.9.2\",\n    \"typescript\": \"^5.3.3\"\n  }\n}",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "tsconfig.json",
      "content": "{\\n  \\\"compilerOptions\\\": {\\n    \\\"target\\\": \\\"es6\\\",\\n    \\\"module\\\": \\\"commonjs\\\",\\n    \\\"outDir\\\": \\\"./dist\\\",\\n    \\\"rootDir\\\": \\\"./src\\\",\\    \\\"strict\\\": true,\\n    \\\"esModuleInterop\\\": true,\\n    \\\"skipLibCheck\\\": true,\\\n    \\\"forceConsistentCasingInFileNames\\\": true\\n  },\\n  \\\"include\\\": [\\n    \\\"src/**/*.ts\\\"\\n  ],\\n  \\\"exclude\\\": [\\n    \\\"node_modules\\\"\\n  ]\\n}",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "src/index.ts",
      "content": "import express from 'express';\n\nimport playerRoutes from './routes/players';\nconst app = express();\nconst PORT = process.env.PORT || 3000;\n\napp.use(express.json());\n\n\napp.use('/players', playerRoutes);\n\napp.get('/', (req, res) => {\n  res.send('Fantasy Soccer Backend is running!');\n});\n\napp.listen(PORT, () => {\n  console.log(`Server is running on port ${PORT}`);\n});\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "src/types/player.ts",
      "content": "export interface Player {\n  id: string;\n  name: string;\n  club: string;\n  position: 'GK' | 'DEF' | 'MID' | 'FWD';\n  photo: string;\n}\n\nexport interface PlayerStats {\n  goals: number;\n  assists: number;\n  appearances: number;\n  cleanSheets: number;\n  yellowCards: number;\n  redCards: number;\n}\n\nexport interface PlayerDetail extends Player {\n  stats: PlayerStats;\n  fantasyScore: number;\n}\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "src/routes/players.ts",
      "content": "import { Router, Request, Response } from 'express';\nimport { Player, PlayerStats, PlayerDetail } from '../types/player';\n\n// Simple in-memory cache\nconst playerCache: { [key: string]: { data: any; timestamp: number } } = {};\nconst CACHE_DURATION = 5 * 60 * 1000; // 5 minutes\n\nconst getCachedData = (key: string) => {\n  const entry = playerCache[key];\n  if (entry && (Date.now() - entry.timestamp < CACHE_DURATION)) {\n    return entry.data;\n  }\n  return null;\n};\n\nconst setCachedData = (key: string, data: any) => {\n  playerCache[key] = { data, timestamp: Date.now() };\n};\n\n// Mock Data (replace with actual data fetching later)\nconst mockPlayers: Player[] = [\n  {\n    id: '1',\n    name: 'Lionel Messi',\n    club: 'PSG',\n    position: 'FWD',\n    photo: 'https://example.com/messi.jpg',\n  },\n  {\n    id: '2',\n    name: 'Cristiano Ronaldo',\n    club: 'Al Nassr',\n    position: 'FWD',\n    photo: 'https://example.com/ronaldo.jpg',\n  },\n  {\n    id: '3',\n    name: 'Virgil van Dijk',\n    club: 'Liverpool',\n    position: 'DEF',\n    photo: 'https://example.com/vandijk.jpg',\n  },\n  {\n    id: '4',\n    name: 'Kevin De Bruyne',\n    club: 'Manchester City',\n    position: 'MID',\n    photo: 'https://example.com/debruyne.jpg',\n  },\n];\n\nconst mockPlayerStats: { [key: string]: PlayerStats } = {\n  '1': { goals: 30, assists: 20, appearances: 40, cleanSheets: 0, yellowCards: 2, redCards: 0 },\n  '2': { goals: 25, assists: 10, appearances: 35, cleanSheets: 0, yellowCards: 5, redCards: 1 },\n  '3': { goals: 3, assists: 5, appearances: 45, cleanSheets: 20, yellowCards: 3, redCards: 0 },\n  '4': { goals: 15, assists: 25, appearances: 38, cleanSheets: 0, yellowCards: 4, redCards: 0 },\n};\n\n// Helper function to calculate fantasy score\nconst calculateFantasyScore = (stats: PlayerStats): number => {\n  return (\n    stats.goals * 4 +\n    stats.assists * 3 +\n    stats.cleanSheets * 2 -\n    stats.yellowCards -\n    stats.redCards * 3\n  );\n};\n\n// Middleware for player validation\nconst validatePlayerId = (req: Request, res: Response, next: Function) => {\n  const { id } = req.params;\n  if (!mockPlayers.some(p => p.id === id)) {\n    return res.status(404).send('Player not found');\n  }\n  next();\n};\n\n// GET /players\nrouter.get('/', (req: Request, res: Response) => {\n  const cachedPlayers = getCachedData('allPlayers');\n  if (cachedPlayers) {\n    return res.json(cachedPlayers);\n  }\n  setCachedData('allPlayers', mockPlayers);\n  res.json(mockPlayers);\n});\n\n// GET /players/:id/stats\nrouter.get('/:id/stats', validatePlayerId, (req: Request, res: Response) => {\n  const { id } = req.params;\n  const cacheKey = `playerStats-${id}`;\n  const cachedStats = getCachedData(cacheKey);\n  if (cachedStats) {\n    return res.json(cachedStats);\n  }\n  const stats = mockPlayerStats[id];\n  if (stats) {\n    setCachedData(cacheKey, stats);\n    res.json(stats);\n  } else {\n    res.status(404).send('Player stats not found');\n  }\n});\n\n// GET /players/:id/fantasyScore\nrouter.get('/:id/fantasyScore', validatePlayerId, (req: Request, res: Response) => {\n  const { id } = req.params;\n  const cacheKey = `fantasyScore-${id}`;\n  const cachedScore = getCachedData(cacheKey);\n  if (cachedScore) {\n    return res.json(cachedScore);\n  }\n  const stats = mockPlayerStats[id];\n  if (stats) {\n    const fantasyScore = calculateFantasyScore(stats);\n    setCachedData(cacheKey, { id, fantasyScore });\n    res.json({ id, fantasyScore });\n  } else {\n    res.status(404).send('Player stats not found');\n  }\n});\n\n// GET /topPlayers?limit=10&position=DEF|MID|FWD\nrouter.get('/topPlayers', (req: Request, res: Response) => {\n  const { limit, position } = req.query;\n  const cacheKey = `topPlayers-${limit || 'noLimit'}-${position || 'noPosition'}`;\n  const cachedTopPlayers = getCachedData(cacheKey);\n  if (cachedTopPlayers) {\n    return res.json(cachedTopPlayers);\n  }\n\n  let filteredPlayers: PlayerDetail[] = [];\n\n  // Combine mockPlayers with their stats and fantasy scores\n  const playersWithScores: PlayerDetail[] = mockPlayers.map(player => {\n    const stats = mockPlayerStats[player.id];\n    const fantasyScore = stats ? calculateFantasyScore(stats) : 0;\n    return { ...player, stats, fantasyScore };\n  });\n\n  // Filter by position if provided\n  if (position && typeof position === 'string') {\n    filteredPlayers = playersWithScores.filter(player => player.position === (position as string).toUpperCase());\n  } else {\n    filteredPlayers = playersWithScores;\n  }\n\n  // Sort by fantasy score in descending order\n  filteredPlayers.sort((a, b) => b.fantasyScore - a.fantasyScore);\n\n  // Apply limit if provided\n  if (limit) {\n    const parsedLimit = parseInt(limit as string, 10);\n    if (!isNaN(parsedLimit)) {\n      filteredPlayers = filteredPlayers.slice(0, parsedLimit);\n    }\n  }\n\n  setCachedData(cacheKey, filteredPlayers);\n  res.json(filteredPlayers);\n});\n\nexport default router;\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/package.json",
      "content": "{\n  \"name\": \"fantasy-soccer-frontend\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"dependencies\": {\n    \"@testing-library/jest-dom\": \"^5.17.0\",\n    \"@testing-library/react\": \"^13.4.0\",\n    \"@testing-library/user-event\": \"^13.5.0\",\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\",\n    \"react-scripts\": \"5.0.1\",\n    \"web-vitals\": \"^2.1.4\",\n    \"chart.js\": \"^4.4.1\",\n    \"react-chartjs-2\": \"^5.2.0\",\n    \"@hello-pangea/dnd\": \"^16.6.0\"\n  },\n  \"scripts\": {\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\",\n    \"test\": \"react-scripts test\",\n    \"eject\": \"react-scripts eject\"\n  },\n  \"eslintConfig\": {\n    \"extends\": [\n      \"react-app\",\n      \"react-app/jest\"\n    ]\n  },\n  \"browserslist\": {\n    \"production\": [\n      \">0.2%\",\n      \"not dead\",\n      \"not op_mini all\"\n    ],\n    \"development\": [\n      \"last 1 chrome version\",\n      \"last 1 firefox version\",\n      \"last 1 safari version\"\n    ]\n  },\n  \"devDependencies\": {\n    \"@types/jest\": \"^27.5.2\",\n    \"@types/node\": \"^16.18.79\",\n    \"@types/react\": \"^18.2.52\",\n    \"@types/react-dom\": \"^18.2.18\",\n    \"tailwindcss\": \"^3.4.1\",\n    \"typescript\": \"^4.9.5\"\n  }\n}\n",
      "previousContent": "{\n  \"name\": \"fantasy-soccer-frontend\",\n  \"version\": \"0.1.0\",\n  \"private\": true,\n  \"dependencies\": {\n    \"@testing-library/jest-dom\": \"^5.17.0\",\n    \"@testing-library/react\": \"^13.4.0\",\n    \"@testing-library/user-event\": \"^13.5.0\",\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\",\n    \"react-scripts\": \"5.0.1\",\n    \"web-vitals\": \"^2.1.4\",\n    \"chart.js\": \"^4.4.1\",\n    \"react-chartjs-2\": \"^5.2.0\"\n  },\n  \"scripts\": {\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\",\n    \"test\": \"react-scripts test\",\n    \"eject\": \"react-scripts eject\"\n  },\n  \"eslintConfig\": {\n    \"extends\": [\n      \"react-app\",\n      \"react-app/jest\"\n    ]\n  },\n  \"browserslist\": {\n    \"production\": [\n      \">0.2%\",\n      \"not dead\",\n      \"not op_mini all\"\n    ],\n    \"development\": [\n      \"last 1 chrome version\",\n      \"last 1 firefox version\",\n      \"last 1 safari version\"\n    ]\n  },\n  \"devDependencies\": {\n    \"@types/jest\": \"^27.5.2\",\n    \"@types/node\": \"^16.18.79\",\n    \"@types/react\": \"^18.2.52\",\n    \"@types/react-dom\": \"^18.2.18\",\n    \"tailwindcss\": \"^3.4.1\",\n    \"typescript\": \"^4.9.5\"\n  }\n}\n",
      "language": "auto"
    },
    {
      "path": "frontend/tsconfig.json",
      "content": "{\n  \"compilerOptions\": {\n    \"target\": \"es5\",\n    \"lib\": [\n      \"dom\",\n      \"dom.iterable\",\n      \"esnext\"\n    ],\n    \"allowJs\": true,\n    \"skipLibCheck\": true,\n    \"esModuleInterop\": true,\n    \"allowSyntheticDefaultImports\": true,\n    \"strict\": true,\n    \"forceConsistentCasingInFileNames\": true,\n    \"noFallthroughCasesInSwitch\": true,\n    \"module\": \"esnext\",\n    \"moduleResolution\": \"node\",\n    \"resolveJsonModule\": true,\n    \"isolatedModules\": true,\n    \"noEmit\": true,\n    \"jsx\": \"react-jsx\"\n  },\n  \"include\": [\n    \"src\"\n  ]\n}\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/public/index.html",
      "content": "<!DOCTYPE html>\n<html lang=\"en\">\n  <head>\n    <meta charset=\"utf-8\" />\n    <link rel=\"icon\" href=\"%PUBLIC_URL%/favicon.ico\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n    <meta name=\"theme-color\" content=\"#000000\" />\n    <meta\n      name=\"description\"\n      content=\"Web site created using create-react-app\"\n    />\n    <link rel=\"apple-touch-icon\" href=\"%PUBLIC_URL%/logo192.png\" />\n    <!--\n      manifest.json provides metadata used when your web app is installed on a\n      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/\n    -->\n    <link rel=\"manifest\" href=\"%PUBLIC_URL%/manifest.json\" />\n    <!--\n      Notice the use of %PUBLIC_URL% in the tags above.\n      It will be replaced with the URL of the `public` folder during the build.\n      Only files inside the `public` folder can be referenced from the HTML.\n\n      Unlike \"/favicon.ico\" or \"favicon.ico\", \"%PUBLIC_URL%/favicon.ico\" will\n      work correctly both with client-side routing and a non-root public URL.\n      Learn how to configure a non-root public URL by running `npm run build`.\n    -->\n    <title>React App</title>\n  </head>\n  <body>\n    <noscript>You need to enable JavaScript to run this app.</noscript>\n    <div id=\"root\"></div>\n    <!--\n      This HTML file is a template.\n      If you open it directly in the browser, you will see an empty page.\n\n      You can add webfonts, meta tags, or analytics to this file.\n      The build step will place the bundled scripts into the <body> tag.\n\n      To begin the development, run `npm start` or `yarn start`.\n      To create a production bundle, use `npm run build` or `yarn build`.\n    -->\n  </body>\n</html>\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/src/index.tsx",
      "content": "import React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nconst root = ReactDOM.createRoot(\n  document.getElementById('root') as HTMLElement\n);\nroot.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/src/App.tsx",
      "content": "import React, { useEffect, useState, useReducer, useCallback } from 'react';\nimport { Player, PlayerStats, PlayerDetail } from './types/player';\nimport PlayerCard from './components/PlayerCard';\nimport FantasyTeamPositionChart from './components/FantasyTeamPositionChart';\nimport FantasyScoreBarChart from './components/FantasyScoreBarChart';\nimport { DragDropContext, Droppable, Draggable, DropResult } from '@hello-pangea/dnd';\n\n// Define types for useReducer\ninterface FantasyTeamState {\n  players: PlayerDetail[];\n}\n\ntype FantasyTeamAction = \n  | { type: 'ADD_PLAYER'; payload: PlayerDetail }\n  | { type: 'REMOVE_PLAYER'; payload: string }\n  | { type: 'REORDER_PLAYERS'; payload: PlayerDetail[] };\n\nconst fantasyTeamReducer = (state: FantasyTeamState, action: FantasyTeamAction): FantasyTeamState => {\n  switch (action.type) {\n    case 'ADD_PLAYER':\n      // Prevent adding the same player twice\n      if (state.players.find(p => p.id === action.payload.id)) {\n        return state;\n      }\n      return { ...state, players: [...state.players, action.payload] };\n    case 'REMOVE_PLAYER':\n      return { ...state, players: state.players.filter(player => player.id !== action.payload) };\n    case 'REORDER_PLAYERS':\n      return { ...state, players: action.payload };\n    default:\n      return state;\n  }\n};\n\ntype SortKey = 'name' | 'club' | 'position' | 'goals' | 'assists' | 'fantasyScore';\n\nfunction App() {\n  const [allPlayers, setAllPlayers] = useState<PlayerDetail[]>([]);\n  const [filteredPlayers, setFilteredPlayers] = useState<PlayerDetail[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [sortKey, setSortKey] = useState<SortKey>('name');\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('asc');\n\n  const [fantasyTeamState, dispatch] = useReducer(fantasyTeamReducer, { players: [] });\n\n  const fetchAllPlayerDetails = useCallback(async () => {\n    try {\n      const playersResponse = await fetch('http://localhost:3000/players');\n      if (!playersResponse.ok) {\n        throw new Error(`HTTP error! status: ${playersResponse.status}`);\n      }\n      const playersData: Player[] = await playersResponse.json();\n\n      const detailedPlayersPromises = playersData.map(async (player) => {\n        const statsResponse = await fetch(`http://localhost:3000/players/${player.id}/stats`);\n        const scoreResponse = await fetch(`http://localhost:3000/players/${player.id}/fantasyScore`);\n\n        if (!statsResponse.ok || !scoreResponse.ok) {\n          throw new Error(`Failed to fetch details for player ${player.name}`);\n        }\n\n        const statsData: PlayerStats = await statsResponse.json();\n        const scoreData: { id: string; fantasyScore: number } = await scoreResponse.json();\n\n        return { ...player, stats: statsData, fantasyScore: scoreData.fantasyScore };\n      });\n\n      const detailedPlayers = await Promise.all(detailedPlayersPromises);\n      setAllPlayers(detailedPlayers);\n      setFilteredPlayers(detailedPlayers); // Initialize filtered players with all players\n    } catch (e: any) {\n      setError(e.message);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchAllPlayerDetails();\n  }, [fetchAllPlayerDetails]);\n\n  useEffect(() => {\n    let results = [...allPlayers.filter(player =>\n      player.name.toLowerCase().includes(searchTerm.toLowerCase())\n    )];\n\n    // Apply sorting\n    results.sort((a, b) => {\n      let valA: string | number;\n      let valB: string | number;\n\n      if (sortKey === 'name' || sortKey === 'club' || sortKey === 'position') {\n        valA = a[sortKey];\n        valB = b[sortKey];\n      } else if (sortKey === 'goals' || sortKey === 'assists') {\n        valA = a.stats[sortKey]; \n        valB = b.stats[sortKey];\n      } else if (sortKey === 'fantasyScore') {\n        valA = a.fantasyScore;\n        valB = b.fantasyScore;\n      } else {\n        valA = 0; // Default or handle other cases\n        valB = 0;\n      }\n\n      if (typeof valA === 'string' && typeof valB === 'string') {\n        return sortDirection === 'asc' ? valA.localeCompare(valB) : valB.localeCompare(valA);\n      } else if (typeof valA === 'number' && typeof valB === 'number') {\n        return sortDirection === 'asc' ? valA - valB : valB - valA;\n      }\n      return 0;\n    });\n\n    setFilteredPlayers(results);\n  }, [searchTerm, allPlayers, sortKey, sortDirection]);\n\n  const handleAddToTeam = (player: PlayerDetail) => {\n    dispatch({ type: 'ADD_PLAYER', payload: player });\n  };\n\n  const handleRemoveFromTeam = (playerId: string) => {\n    dispatch({ type: 'REMOVE_PLAYER', payload: playerId });\n  };\n\n  const handleSort = (key: SortKey) => {\n    if (sortKey === key) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortKey(key);\n      setSortDirection('asc');\n    }\n  };\n\n  const onDragEnd = (result: DropResult) => {\n    if (!result.destination) {\n      return;\n    }\n\n    const reorderedPlayers = Array.from(fantasyTeamState.players);\n    const [removed] = reorderedPlayers.splice(result.source.index, 1);\n    reorderedPlayers.splice(result.destination.index, 0, removed);\n\n    dispatch({ type: 'REORDER_PLAYERS', payload: reorderedPlayers });\n  };\n\n  if (loading) {\n    return <div className=\"text-center mt-8\">Loading players...</div>;\n  }\n\n  if (error) {\n    return <div className=\"text-center mt-8 text-red-500\">Error: {error}</div>;\n  }\n\n  return (\n    <div className=\"container mx-auto p-4 bg-gray-100 min-h-screen\">\n      <h1 className=\"text-4xl font-bold text-center mb-8 text-gray-800\">Fantasy Soccer Dashboard</h1>\n\n      <div className=\"mb-8 p-4 bg-white rounded shadow-md\">\n        <h2 className=\"text-2xl font-bold mb-4\">Search Players</h2>\n        <input\n          type=\"text\"\n          placeholder=\"Search by player name...\"\n          className=\"w-full p-2 border border-gray-300 rounded mb-4\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n        />\n\n        <h3 className=\"text-xl font-bold mb-3\">All Players</h3>\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full bg-white border border-gray-300\">\n            <thead>\n              <tr>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('name')}>Name {sortKey === 'name' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('club')}>Club {sortKey === 'club' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('position')}>Position {sortKey === 'position' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('goals')}>Goals {sortKey === 'goals' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('assists')}>Assists {sortKey === 'assists' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('fantasyScore')}>Fantasy Score {sortKey === 'fantasyScore' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b\">Action</th>\n              </tr>\n            </thead>\n            <tbody>\n              {filteredPlayers.map((player) => (\n                <tr key={player.id} className=\"hover:bg-gray-50\">\n                  <td className=\"py-2 px-4 border-b flex items-center\">\n                    <img src={player.photo} alt={player.name} className=\"w-8 h-8 rounded-full mr-2 object-cover\" />\n                    {player.name}\n                  </td>\n                  <td className=\"py-2 px-4 border-b\">{player.club}</td>\n                  <td className=\"py-2 px-4 border-b\">{player.position}</td>\n                  <td className=\"py-2 px-4 border-b\">{player.stats.goals}</td>\n                  <td className=\"py-2 px-4 border-b\">{player.stats.assists}</td>\n                  <td className=\"py-2 px-4 border-b font-bold\">{player.fantasyScore}</td>\n                  <td className=\"py-2 px-4 border-b\">\n                    <button\n                      onClick={() => handleAddToTeam(player)}\n                      className=\"bg-green-500 hover:bg-green-700 text-white text-sm py-1 px-3 rounded\"\n                    >\n                      Add\n                    </button>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <div className=\"p-4 bg-white rounded shadow-md\">\n        <h2 className=\"text-2xl font-bold mb-4\">Your Fantasy Team ({fantasyTeamState.players.length} players)</h2>\n        {fantasyTeamState.players.length === 0 ? (\n          <p className=\"text-gray-600\">No players in your fantasy team yet. Add some!</p>\n        ) : (\n          <DragDropContext onDragEnd={onDragEnd}>\n            <Droppable droppableId=\"fantasy-team-droppable\">\n              {(provided) => (\n                <div\n                  {...provided.droppableProps}\n                  ref={provided.innerRef}\n                  className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\"\n                >\n                  {fantasyTeamState.players.map((player, index) => (\n                    <Draggable key={player.id} draggableId={player.id} index={index}>\n                      {(provided) => (\n                        <div\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                          {...provided.dragHandleProps}\n                          className=\"border p-3 rounded shadow-sm flex items-center justify-between bg-gray-50\"\n                        >\n                          <div className=\"flex items-center\">\n                            <img src={player.photo} alt={player.name} className=\"w-12 h-12 rounded-full mr-3 object-cover\" />\n                            <div>\n                              <p className=\"font-bold\">{player.name}</p>\n                              <p className=\"text-sm text-gray-600\">{player.club} - {player.position}</p>\n                            </div>\n                          </div>\n                          <button\n                            onClick={() => handleRemoveFromTeam(player.id)}\n                            className=\"bg-red-500 hover:bg-red-700 text-white text-sm py-1 px-3 rounded\"\n                          >\n                            Remove\n                          </button>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n                  {provided.placeholder}\n                </div>\n              )}\n            </Droppable>\n          </DragDropContext>\n        )}\n\n        <div className=\"mt-8 flex flex-wrap justify-center gap-4\">\n          <FantasyTeamPositionChart players={fantasyTeamState.players} />\n          <FantasyScoreBarChart players={fantasyTeamState.players} />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n",
      "previousContent": "import React, { useEffect, useState, useReducer, useCallback } from 'react';\nimport { Player, PlayerStats, PlayerDetail } from './types/player';\nimport FantasyTeamPositionChart from './components/FantasyTeamPositionChart';\nimport FantasyScoreBarChart from './components/FantasyScoreBarChart';\nimport PlayerCard from './components/PlayerCard';\n\nconst PlayerCard: React.FC<PlayerCardProps> = ({ player, onAddToTeam }) => {\n  return (\n    <div className=\"border p-4 m-2 rounded shadow-lg flex flex-col items-center bg-white\">\n      <img src={player.photo} alt={player.name} className=\"w-24 h-24 rounded-full mx-auto mb-2 object-cover\" />\n      <h3 className=\"font-bold text-lg text-center\">{player.name}</h3>\n      <p className=\"text-center text-gray-600\">{player.club} - {player.position}</p>\n\n      <div className=\"mt-4 text-sm w-full text-left\">\n        <p><strong>Goals:</strong> {player.stats.goals}</p>\n        <p><strong>Assists:</strong> {player.stats.assists}</p>\n        <p><strong>Appearances:</strong> {player.stats.appearances}</p>\n        <p><strong>Clean Sheets:</strong> {player.stats.cleanSheets}</p>\n        <p><strong>Yellow Cards:</strong> {player.stats.yellowCards}</p>\n        <p><strong>Red Cards:</strong> {player.stats.redCards}</p>\n        <p className=\"text-lg font-bold mt-2\">Fantasy Score: {player.fantasyScore}</p>\n      </div>\n      <button\n        onClick={() => onAddToTeam(player)}\n        className=\"mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\n      >\n        Add to Team\n      </button>\n    </div>\n  );\n};\n\ntype SortKey = 'name' | 'club' | 'position' | 'goals' | 'assists' | 'fantasyScore';\n\nfunction App() {\n  const [allPlayers, setAllPlayers] = useState<PlayerDetail[]>([]);\n  const [filteredPlayers, setFilteredPlayers] = useState<PlayerDetail[]>([]);\n  const [loading, setLoading] = useState<boolean>(true);\n  const [error, setError] = useState<string | null>(null);\n  const [searchTerm, setSearchTerm] = useState<string>('');\n  const [sortKey, setSortKey] = useState<SortKey>('name');\n  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('asc');\n\n  const [fantasyTeamState, dispatch] = useReducer(fantasyTeamReducer, { players: [] });\n\n  const fetchAllPlayerDetails = useCallback(async () => {\n    try {\n      const playersResponse = await fetch('http://localhost:3000/players');\n      if (!playersResponse.ok) {\n        throw new Error(`HTTP error! status: ${playersResponse.status}`);\n      }\n      const playersData: Player[] = await playersResponse.json();\n\n      const detailedPlayersPromises = playersData.map(async (player) => {\n        const statsResponse = await fetch(`http://localhost:3000/players/${player.id}/stats`);\n        const scoreResponse = await fetch(`http://localhost:3000/players/${player.id}/fantasyScore`);\n\n        if (!statsResponse.ok || !scoreResponse.ok) {\n          throw new Error(`Failed to fetch details for player ${player.name}`);\n        }\n\n        const statsData: PlayerStats = await statsResponse.json();\n        const scoreData: { id: string; fantasyScore: number } = await scoreResponse.json();\n\n        return { ...player, stats: statsData, fantasyScore: scoreData.fantasyScore };\n      });\n\n      const detailedPlayers = await Promise.all(detailedPlayersPromises);\n      setAllPlayers(detailedPlayers);\n      setFilteredPlayers(detailedPlayers); // Initialize filtered players with all players\n    } catch (e: any) {\n      setError(e.message);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchAllPlayerDetails();\n  }, [fetchAllPlayerDetails]);\n\n  useEffect(() => {\n    let results = allPlayers.filter(player =>\n      player.name.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n    // Apply sorting\n    results.sort((a, b) => {\n      let valA: string | number;\n      let valB: string | number;\n\n      if (sortKey === 'name' || sortKey === 'club' || sortKey === 'position') {\n        valA = a[sortKey];\n        valB = b[sortKey];\n      } else {\n        valA = a.stats ? a.stats[sortKey as keyof PlayerStats] : 0; // For stats-related keys\n        valB = b.stats ? b.stats[sortKey as keyof PlayerStats] : 0;\n        if (sortKey === 'fantasyScore') {\n          valA = a.fantasyScore;\n          valB = b.fantasyScore;\n        }\n      }\n\n      if (typeof valA === 'string' && typeof valB === 'string') {\n        return sortDirection === 'asc' ? valA.localeCompare(valB) : valB.localeCompare(valA);\n      } else if (typeof valA === 'number' && typeof valB === 'number') {\n        return sortDirection === 'asc' ? valA - valB : valB - valA;\n      }\n      return 0;\n    });\n\n    setFilteredPlayers(results);\n  }, [searchTerm, allPlayers, sortKey, sortDirection]);\n\n  const handleAddToTeam = (player: PlayerDetail) => {\n    dispatch({ type: 'ADD_PLAYER', payload: player });\n  };\n\n  const handleRemoveFromTeam = (playerId: string) => {\n    dispatch({ type: 'REMOVE_PLAYER', payload: playerId });\n  };\n\n  const handleSort = (key: SortKey) => {\n    if (sortKey === key) {\n      setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortKey(key);\n      setSortDirection('asc');\n    }\n  };\n\n  if (loading) {\n    return <div className=\"text-center mt-8\">Loading players...</div>;\n  }\n\n  if (error) {\n    return <div className=\"text-center mt-8 text-red-500\">Error: {error}</div>;\n  }\n\n  return (\n    <div className=\"container mx-auto p-4 bg-gray-100 min-h-screen\">\n      <h1 className=\"text-4xl font-bold text-center mb-8 text-gray-800\">Fantasy Soccer Dashboard</h1>\n\n      <div className=\"mb-8 p-4 bg-white rounded shadow-md\">\n        <h2 className=\"text-2xl font-bold mb-4\">Search Players</h2>\n        <input\n          type=\"text\"\n          placeholder=\"Search by player name...\"\n          className=\"w-full p-2 border border-gray-300 rounded mb-4\"\n          value={searchTerm}\n          onChange={(e) => setSearchTerm(e.target.value)}\n        />\n\n        <h3 className=\"text-xl font-bold mb-3\">All Players</h3>\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full bg-white border border-gray-300\">\n            <thead>\n              <tr>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('name')}>Name {sortKey === 'name' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('club')}>Club {sortKey === 'club' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('position')}>Position {sortKey === 'position' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('goals')}>Goals {sortKey === 'goals' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('assists')}>Assists {sortKey === 'assists' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b cursor-pointer\" onClick={() => handleSort('fantasyScore')}>Fantasy Score {sortKey === 'fantasyScore' && (sortDirection === 'asc' ? '▲' : '▼')}</th>\n                <th className=\"py-2 px-4 border-b\">Action</th>\n              </tr>\n            </thead>\n            <tbody>\n              {filteredPlayers.map((player) => (\n                <tr key={player.id} className=\"hover:bg-gray-50\">\n                  <td className=\"py-2 px-4 border-b flex items-center\">\n                    <img src={player.photo} alt={player.name} className=\"w-8 h-8 rounded-full mr-2 object-cover\" />\n                    {player.name}\n                  </td>\n                  <td className=\"py-2 px-4 border-b\">{player.club}</td>\n                  <td className=\"py-2 px-4 border-b\">{player.position}</td>\n                  <td className=\"py-2 px-4 border-b\">{player.stats.goals}</td>\n                  <td className=\"py-2 px-4 border-b\">{player.stats.assists}</td>\n                  <td className=\"py-2 px-4 border-b font-bold\">{player.fantasyScore}</td>\n                  <td className=\"py-2 px-4 border-b\">\n                    <button\n                      onClick={() => handleAddToTeam(player)}\n                      className=\"bg-green-500 hover:bg-green-700 text-white text-sm py-1 px-3 rounded\"\n                    >\n                      Add\n                    </button>\n                  </td>\n                </tr>\n              ))}\n          <FantasyTeamPositionChart players={fantasyTeamState.players} />\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <div className=\"p-4 bg-white rounded shadow-md\">\n        <h2 className=\"text-2xl font-bold mb-4\">Your Fantasy Team ({fantasyTeamState.players.length} players)</h2>\n        {fantasyTeamState.players.length === 0 ? (\n          <p className=\"text-gray-600\">No players in your fantasy team yet. Add some!</p>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {fantasyTeamState.players.map((player) => (\n              <div key={player.id} className=\"border p-3 rounded shadow-sm flex items-center justify-between bg-gray-50\">\n                <div className=\"flex items-center\">\n                  <img src={player.photo} alt={player.name} className=\"w-12 h-12 rounded-full mr-3 object-cover\" />\n                  <div>\n                    <p className=\"font-bold\">{player.name}</p>\n                    <p className=\"text-sm text-gray-600\">{player.club} - {player.position}</p>\n                  </div>\n                </div>\n                <button\n                  onClick={() => handleRemoveFromTeam(player.id)}\n                  className=\"bg-red-500 hover:bg-red-700 text-white text-sm py-1 px-3 rounded\"\n                >\n                  Remove\n                </button>\n              </div>\n          <FantasyScoreBarChart players={fantasyTeamState.players} />\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n",
      "language": "auto"
    },
    {
      "path": "frontend/tailwind.config.js",
      "content": "/** @type {import('tailwindcss').Config} */\nmodule.exports = {\n  content: [\n    \"./src/**/*.{js,jsx,ts,tsx}\",\n  ],\n  theme: {\n    extend: {},\n  },\n  plugins: [],\n};\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/postcss.config.js",
      "content": "module.exports = {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n};\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/src/index.css",
      "content": "@tailwind base;\n@tailwind components;\n@tailwind utilities;\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/src/types/player.ts",
      "content": "export interface Player {\n  id: string;\n  name: string;\n  club: string;\n  position: 'GK' | 'DEF' | 'MID' | 'FWD';\n  photo: string;\n}\n\nexport interface PlayerStats {\n  goals: number;\n  assists: number;\n  appearances: number;\n  cleanSheets: number;\n  yellowCards: number;\n  redCards: number;\n}\n\nexport interface PlayerDetail extends Player {\n  stats: PlayerStats;\n  fantasyScore: number;\n}\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/src/components/FantasyTeamPositionChart.tsx",
      "content": "import React from 'react';\nimport { Pie } from 'react-chartjs-2';\nimport { Chart as ChartJS, ArcElement, Tooltip, Legend } from 'chart.js';\nimport { PlayerDetail } from '../types/player';\n\nChartJS.register(ArcElement, Tooltip, Legend);\n\ninterface FantasyTeamPositionChartProps {\n  players: PlayerDetail[];\n}\n\nconst FantasyTeamPositionChart: React.FC<FantasyTeamPositionChartProps> = ({ players }) => {\n  const positionCounts = players.reduce((acc, player) => {\n    acc[player.position] = (acc[player.position] || 0) + 1;\n    return acc;\n  }, {} as Record<string, number>);\n\n  const data = {\n    labels: Object.keys(positionCounts),\n    datasets: [\n      {\n        label: 'Players',\n        data: Object.values(positionCounts),\n        backgroundColor: [\n          'rgba(255, 99, 132, 0.6)', // FWD\n          'rgba(54, 162, 235, 0.6)', // MID\n          'rgba(255, 206, 86, 0.6)', // DEF\n          'rgba(75, 192, 192, 0.6)', // GK\n        ],\n        borderColor: [\n          'rgba(255, 99, 132, 1)',\n          'rgba(54, 162, 235, 1)',\n          'rgba(255, 206, 86, 1)',\n          'rgba(75, 192, 192, 1)',\n        ],\n        borderWidth: 1,\n      },\n    ],\n  };\n\n  const options = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: 'top' as const,\n      },\n      title: {\n        display: true,\n        text: 'Fantasy Team Position Distribution',\n      },\n    },\n  };\n\n  return (\n    <div className=\"w-full md:w-1/2 lg:w-1/3 mx-auto p-4\">\n      <Pie data={data} options={options} />\n    </div>\n  );\n};\n\nexport default FantasyTeamPositionChart;\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/src/components/PlayerCard.tsx",
      "content": "import React, { useState, useEffect } from 'react';\nimport { PlayerDetail, PlayerStats } from '../types/player';\n\ninterface PlayerCardProps {\n  player: PlayerDetail;\n  onAddToTeam: (player: PlayerDetail) => void; // New prop for adding to team\n}\n\nconst PlayerCard: React.FC<PlayerCardProps> = ({ player, onAddToTeam }) => {\n  // Note: Stats and fantasyScore are now directly available in player: PlayerDetail\n  // No need to fetch them individually here anymore\n\n  return (\n    <div className=\"border p-4 m-2 rounded shadow-lg flex flex-col items-center bg-white\">\n      <img src={player.photo} alt={player.name} className=\"w-24 h-24 rounded-full mx-auto mb-2 object-cover\" />\n      <h3 className=\"font-bold text-lg text-center\">{player.name}</h3>\n      <p className=\"text-center text-gray-600\">{player.club} - {player.position}</p>\n\n      <div className=\"mt-4 text-sm w-full text-left\">\n        <p><strong>Goals:</strong> {player.stats.goals}</p>\n        <p><strong>Assists:</strong> {player.stats.assists}</p>\n        <p><strong>Appearances:</strong> {player.stats.appearances}</p>\n        <p><strong>Clean Sheets:</strong> {player.stats.cleanSheets}</p>\n        <p><strong>Yellow Cards:</strong> {player.stats.yellowCards}</p>\n        <p><strong>Red Cards:</strong> {player.stats.redCards}</p>\n        <p className=\"text-lg font-bold mt-2\">Fantasy Score: {player.fantasyScore}</p>\n      </div>\n      <button\n        onClick={() => onAddToTeam(player)}\n        className=\"mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\"\n      >\n        Add to Team\n      </button>\n    </div>\n  );\n};\n\nexport default PlayerCard;\n",
      "previousContent": null,
      "language": "auto"
    },
    {
      "path": "frontend/src/components/FantasyScoreBarChart.tsx",
      "content": "import React from 'react';\nimport { Bar } from 'react-chartjs-2';\nimport { Chart as ChartJS, CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend } from 'chart.js';\nimport { PlayerDetail } from '../types/player';\n\nChartJS.register(CategoryScale, LinearScale, BarElement, Title, Tooltip, Legend);\n\ninterface FantasyScoreBarChartProps {\n  players: PlayerDetail[];\n}\n\nconst FantasyScoreBarChart: React.FC<FantasyScoreBarChartProps> = ({ players }) => {\n  const data = {\n    labels: players.map(player => player.name),\n    datasets: [\n      {\n        label: 'Fantasy Score',\n        data: players.map(player => player.fantasyScore),\n        backgroundColor: 'rgba(153, 102, 255, 0.6)',\n        borderColor: 'rgba(153, 102, 255, 1)',\n        borderWidth: 1,\n      },\n    ],\n  };\n\n  const options = {\n    responsive: true,\n    plugins: {\n      legend: {\n        position: 'top' as const,\n      },\n      title: {\n        display: true,\n        text: 'Fantasy Team Score Comparison',\n      },\n    },\n    scales: {\n      y: {\n        beginAtZero: true,\n        title: {\n          display: true,\n          text: 'Fantasy Score',\n        },\n      },\n    },\n  };\n\n  return (\n    <div className=\"w-full md:w-full lg:w-2/3 mx-auto p-4\">\n      <Bar data={data} options={options} />\n    </div>\n  );\n};\n\nexport default FantasyScoreBarChart;\n",
      "previousContent": null,
      "language": "auto"
    }
  ]
}